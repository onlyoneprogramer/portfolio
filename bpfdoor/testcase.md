# 테스트 케이스 및 실험 결과

## 테스트 케이스 정의

| 테스트 케이스 | 설명 |
|---------------|------|
| **TC1** | BPFdoor가 특정 포트에 숨겨진 채 리스닝, 외부 접근 시에만 활성화 |
| **TC2** | `syscall` 테이블에 `bpf()`, `connect()` 등의 항목을 후킹 |
| **TC3** | `netfilter hook`에 eBPF map 연결 후 행동 조작 |
| **TC4** | LKM을 통해 `bpf syscall`을 감싸는 루틴 삽입 |
| **TC5** | `agent-main`이 강제 종료됨 (공격자에 의한 제거 시나리오) |
| **TC6** | 하이퍼바이저 접근 로그 위조 및 은폐 시도 |

---

## 4.4.1 탐지 정확도

| 시나리오 | VMI 탐지 | Agent 탐지 | 무결성 탐지 |
|----------|-----------|-------------|----------------|
| **TC1**  | ✔         | ✔           | ❌             |
| **TC2**  | ✔         | ❌          | ✔              |
| **TC3**  | ✔         | ✔           | ✔              |
| **TC4**  | ✔         | ❌          | ✔              |
| **TC5**  | ❌        | ✔           | ❌             |
| **TC6**  | ✔         | ✔           | ❌             |

---

## 분석 요약

- **VMI(Virtual Machine Introspection)**: 거의 모든 케이스에서 탐지 성공, 하이퍼바이저 기반 감시의 강력함 입증
- **Agent**: TC2, TC4 같은 커널 레벨 후킹에 취약하지만 사용자 공간 이상 행위는 탐지 가능
- **무결성 검사(Integrity)**: syscall 후킹이나 netfilter 조작과 같은 구조적 변조는 잘 탐지하지만 동적 동작 기반에는 취약

---

